|||template "vueheader" .|||
|||template "treenav" .|||
|||template "caseheader" |||
<fieldset>
<div id="form-newtask">
	<div class="form-horizontal">
		<div class="form-group">
			<label for="routine_name" class="col-sm-2 control-label">Name</label>
			<div class="col-sm-8">
				<input class="form-control required" v-model="ntask.name" type="text" placeholder="Do something"/>
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label">Pre Condition</label>
			<div class="col-sm-8">
				<table class="table table-bordered table-hover">
					<thead>
						<tr>
							<th class="text-center col-sm-1">DUT</th>
							<th class="text-center col-sm-1">Mode</th>
							<th class="text-center col-sm-3">CLI</th>
							<th class="text-center col-sm-4">Expected</th>
							<th class="text-center col-sm-1">+/-</th>
						</tr>

						<tr>
							<td class="text-center"><input type="text" v-model="prcinputs.dut" placeholder='DUT1' class="form-control col-sm-1 required"/></td>
							<td class="text-center"><input type="text" v-model="prcinputs.mode" placeholder='enable' class="form-control col-sm-1 required"/></td>
							<td class="text-center"><input type="text" v-model="prcinputs.cli" placeholder='show runngin-config' class="form-control col-sm-4 required"/></td>
							<td class="text-center"><input type="text" v-model="prcinputs.expected" placeholder='br1000[[_space_]]+up' class="form-control col-sm-4 required"/></td>
							<td class="text-center"><button class="btn btn-success glyphicon glyphicon-plus" @click.prevent="addNewPreCondition"></button></td>
						</tr>
					</thead>
					<tbody v-for="(assertion, index) in ntask.precondition.assertions">
						<tr>
							<td class="text-center">{{assertion.dut}}</td>
							<td class="text-center">{{assertion.mode}}</td>
							<td class="text-center">{{assertion.cli}}</td>
							<td class="text-center">{{assertion.expected}}</td>
							<td class="text-center"><button class="btn btn-danger glyphicon glyphicon-minus" @click.prevent="delPreCondition(index)"></button></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label" for="stage_name">Routine</label>
			<div class="col-sm-8">
				<table class="table table-bordered table-hover">
					<thead>
						<tr>
							<th class="text-center col-sm-1">DUT</th>
							<th class="text-center col-sm-1">Mode</th>
							<th class="text-center col-sm-3">CLI</th>
							<th class="text-center col-sm-4">Expected</th>
							<th class="text-center col-sm-1">+/-</th>
						</tr>
						<td class="text-center"><input type="text" v-model="mrinputs.dut" placeholder='DUT1' class="form-control col-sm-1 required"/></td>
						<td class="text-center"><input type="text" v-model="mrinputs.mode" placeholder='enable' class="form-control col-sm-1 required"/></td>
						<td class="text-center"><input type="text" v-model="mrinputs.cli" placeholder='show runngin-config' class="form-control col-sm-4 required"/></td>
						<td class="text-center"><input type="text" v-model="mrinputs.expected" placeholder='br1000[[_space_]]+up' class="form-control col-sm-4 required"/></td>
						<td class="text-center"><button class="btn btn-success glyphicon glyphicon-plus" @click.prevent="addNewMainRoutine"></button></td>
						</tr>

					</thead>
					<tbody v-for="(assertion, index) in ntask.routine.assertions">
						<tr>
							<td class="text-center">{{assertion.dut}}</td>
							<td class="text-center">{{assertion.mode}}</td>
							<td class="text-center">{{assertion.cli}}</td>
							<td class="text-center">{{assertion.expected}}</td>
							<td class="text-center"><button class="btn btn-danger glyphicon glyphicon-minus" @click.prevent="delMainRoutine(index)"></button></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label" for="stage_name">Post Condition</label>
			<div class="col-sm-8">
				<table class="table table-bordered table-hover">
					<thead>
						<tr>
							<th class="text-center col-sm-1">DUT</th>
							<th class="text-center col-sm-1">Mode</th>
							<th class="text-center col-sm-3">CLI</th>
							<th class="text-center col-sm-4">Expected</th>
							<th class="text-center col-sm-1">+/-</th>
						</tr>
						<td class="text-center"><input type="text" v-model="pocinputs.dut" placeholder='DUT1' class="form-control col-sm-1 required"/></td>
						<td class="text-center"><input type="text" v-model="pocinputs.mode" placeholder='enable' class="form-control col-sm-1 required"/></td>
						<td class="text-center"><input type="text" v-model="pocinputs.cli" placeholder='show runngin-config' class="form-control col-sm-4 required"/></td>
						<td class="text-center"><input type="text" v-model="pocinputs.expected" placeholder='br1000[[_space_]]+up' class="form-control col-sm-4 required"/></td>
						<td class="text-center"><button class="btn btn-success glyphicon glyphicon-plus" @click.prevent="addNewPostCondition"></button></td>
						</tr>

					</thead>
					<tbody v-for="(assertion, index) in ntask.postcondition.assertions">

						<tr>
							<td class="text-center">{{assertion.dut}}</td>
							<td class="text-center">{{assertion.mode}}</td>
							<td class="text-center">{{assertion.cli}}</td>
							<td class="text-center">{{assertion.expected}}</td>
							<td class="text-center"><button class="btn btn-danger glyphicon glyphicon-minus" @click.prevent="delPostCondition(index)"></button></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label" for="stage_name">Clear</label>
			<div class="col-sm-8">
				<table class="table table-bordered table-hover">
					<thead>
						<tr>
							<th class="text-center col-sm-1">DUT</th>
							<th class="text-center col-sm-1">Mode</th>
							<th class="text-center col-sm-3">CLI</th>
							<th class="text-center col-sm-4">Expected</th>
							<th class="text-center col-sm-1">+/-</th>
						</tr>
						<td class="text-center"><input type="text" v-model="crinputs.dut" placeholder='DUT1' class="form-control col-sm-1 required"/></td>
						<td class="text-center"><input type="text" v-model="crinputs.mode" placeholder='enable' class="form-control col-sm-1 required"/></td>
						<td class="text-center"><input type="text" v-model="crinputs.cli" placeholder='show runngin-config' class="form-control col-sm-4 required"/></td>
						<td class="text-center"><input type="text" v-model="crinputs.expected" placeholder='br1000[[_space_]]+up' class="form-control col-sm-4 required"/></td>
						<td class="text-center"><button class="btn btn-success glyphicon glyphicon-plus" @click.prevent="addNewClearRoutine"></button></td>
						</tr>

					</thead>
					<tbody v-for="(assertion, index) in ntask.clear.assertions">
						<tr>

							<td class="text-center">{{assertion.dut}}</td>
							<td class="text-center">{{assertion.mode}}</td>
							<td class="text-center">{{assertion.cli}}</td>
							<td class="text-center">{{assertion.expected}}</td>
							<td class="text-center"><button class="btn btn-danger glyphicon glyphicon-minus" @click.prevent="delClearRoutine(index)"></button></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="col-sm-8 col-sm-offset-2">
			<button class="btn icon-btn btn-success pull-left" @click.prevent="submitForm">Continue</button>
			<button class="btn icon-btn btn-primary pull-right" @click.prevent="submitForm">Finish</button>
		</div>
	</div>
</div>
</fieldset>
<script>
	function dumpCase(id) {
		var caseinfo
		$.ajax({
			type:"get",
			url:"dumpcase?id="+id,
			async:false,
			success:function(data) {
				caseinfo = data;
			}
		});
		return caseinfo;
	}
	functionã€€getCookie(name){
		if (document.cookie.length>0)
		{
			start=document.cookie.indexOf(name + "=");
			if (start!=-1)
			{ 
				start=start + name.length+1;
				c_end=document.cookie.indexOf(";",start);
				if (c_end==-1) c_end=document.cookie.length;
				return unescape(document.cookie.substring(start,c_end));
			} 
		}
		return "";
	}

</script>
<script>
	var newtask = new Vue({
		el: '#form-newtask',
		data: {
			prcinputs: {
				dut:"",
				mode: "",
				cli: "",
				expected: ""
			},
			pocinputs: {
				dut:"",
				mode: "",
				cli: "",
				expected: ""
			},
			mrinputs: {
				dut:"",
				mode: "",
				cli: "",
				expected: ""
			},
			crinputs: {
				dut:"",
				mode: "",
				cli: "",
				expected: ""
			},
			ntask: {
				name: "",
				precondition: {
					assertions:[]
				},
				routine: {
					assertions:[]
				},
				postcondition: {
					assertions:[]
				},
				clear: {
					assertions:[]
				}
			},
			current: dumpCase(getCookie("CASEID")),
			submitted:false
		},
		methods: {
			addNewPreCondition: function(){
				this.ntask.precondition.assertions.push({
					dut: this.prcinputs.dut,
					mode: this.prcinputs.mode,
					cli: this.prcinputs.cli,
					expected: this.prcinputs.expected
				});
				this.inputs = {};
			},
			delPreCondition: function(index){
				this.ntask.precondition.assertions.splice(index, 1);
			},

			addNewPostCondition: function(){
				this.ntask.postcondition.assertions.push({
					dut: this.pocinputs.dut,
					mode: this.pocinputs.mode,
					cli: this.pocinputs.cli,
					expected: this.pocinputs.expected
				});
				this.inputs = {};
			},

			delPostCondition: function(index){
				this.ntask.postcondition.assertions.splice(index, 1);
			},

			addNewMainRoutine: function(){
				this.ntask.routine.assertions.push({
					dut: this.mrinputs.dut,
					mode: this.mrinputs.mode,
					cli: this.mrinputs.cli,
					expected: this.mrinputs.expected
				});
				this.inputs = {};
			},

			delMainRoutine: function(index){
				this.ntask.routine.assertions.splice(index, 1);
			},

			addNewClearRoutine: function(){
				this.ntask.clear.assertions.push({
					dut: this.crinputs.dut,
					mode: this.crinputs.mode,
					cli: this.crinputs.cli,
					expected: this.crinputs.expected
				});
				this.inputs = {};
			},

			delClearRoutine: function(index){
				this.ntask.clear.assertions.splice(index, 1);
			},

			submitForm: function(e) {
				$.ajax({
					type:"post",
					url:"newtask",
					async:false,
					data: {newtask: JSON.stringify(this.ntask)},
					success:function(data) {
						alert(data);
					}
				});
				this.submitted = true;
			}
		}
	});
</script>
|||template "vuefooter"|||
